---
import type { CollectionEntry } from "astro:content";
import LargePromotionalItem from "../businesses/LargePromotionalItem.astro";
import SmallPromotionalItem from "../businesses/SmallPromotionalItem.astro";

interface Props {
    businesses: CollectionEntry<"businesses">[];
    classList?: string;
}

const { businesses, classList } = Astro.props;

if (businesses.length < 4) {
    throw new Error("At least 4 businesses must be provided");
}

// Take the first item for primary and next 3 for secondary
const primaryItem = businesses[0];
const secondaryItems = businesses.slice(1, 4);
---

<section class:list={["gap-4", classList]}>
    {/* Primary promotional item - spans full height */}
    <div class="h-full">
        <LargePromotionalItem
            heroImageSrc={primaryItem.data.heroImage}
            name={primaryItem.data.name}
            description={primaryItem.data.description}
            href={`/businesses/${primaryItem.slug}`}
            className="h-full"
        />
    </div>

    {/* Secondary promotional items column */}
    <div class="grid grid-rows-3 gap-4">
        {
            secondaryItems.map((item) => (
                <SmallPromotionalItem
                    heroImageSrc={item.data.heroImage}
                    name={item.data.name}
                    href={`/businesses/${item.slug}`}
                />
            ))
        }
    </div>
</section>

<style>
    section {
        display: grid;
        grid-template-columns: 1fr 180px;
    }

    @media screen and (min-width: 768px) {
        section {
            grid-template-columns: 1fr 250px;
        }
    }

    @media screen and (min-width: 1200px) {
        section {
            grid-template-columns: 1fr 280px;
        }
    }
</style>
