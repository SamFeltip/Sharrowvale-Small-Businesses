---
import H2 from "@/components/elements/headers/H2.astro";
import SearchWrapper from "@/components/search/SearchWrapper.vue";

import ContentLayout from "@/layouts/ContentLayout.astro";
import HeaderContent from "@/components/HeaderContent.astro";

import Section from "@/components/elements/section.astro";

import { getCollection, type CollectionEntry } from "astro:content";
import ContentCollectionItem from "@/components/elements/ContentCollectionItem.astro";

export async function getStaticPaths() {
    const category: CollectionEntry<"categories">[] =
        await getCollection("categories");
    return category.map((category) => ({
        params: { slug: category.slug },
        props: category,
    }));
}

type Props = CollectionEntry<"categories">;

const entry: Props = Astro.props;

const { Content } = await entry.render();

const { name, description, bannerImage, isGridLayout } = entry.data;

const searchCategoryCollection = [name];
---

<ContentLayout
    title={name}
    description={description}
    image={bannerImage}
    HeaderContent={HeaderContent}
>
    <div data-pagefind-ignore class="flex flex-col">
        <div class="flex flex-col items-center gap-4">
            <ContentCollectionItem>
                <Content />
            </ContentCollectionItem>
        </div>

        <Section>
            <SearchWrapper
                client:only="vue"
                requiredCategories={searchCategoryCollection}
                isGridLayout={isGridLayout}
            />
        </Section>
    </div>
</ContentLayout>
