---
import H2 from "@/components/elements/headers/H2.astro";
import CarouselWrapper from "./CarouselWrapper.vue";
import { getCollection } from "astro:content";

import Section from "@/components/elements/articles/FloatSection.astro";
import { getPlaceCardsFromBusinesses } from "@/scripts/placeCard/handler";
import ScreenWidth from "@/components/elements/ScreenWidth.vue";

const businesses = await getCollection("businesses");

const businessPlaceCards = await getPlaceCardsFromBusinesses(businesses);

businessPlaceCards.forEach(
    (placeCard) =>
        (placeCard.content = placeCard.tags && placeCard.tags[0].name)
);
---

<Section direction="column">
    <ScreenWidth>
        <H2 color="coral" position="center"> Discover more Businesses </H2>
    </ScreenWidth>

    <CarouselWrapper
        client:visible={{ rootMargin: "200px" }}
        items={businessPlaceCards}
    />
</Section>
