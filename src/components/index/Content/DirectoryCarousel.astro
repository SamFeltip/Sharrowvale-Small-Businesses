---
import H2 from "@/components/elements/headers/H2.astro";
import CarouselWrapper from "./CarouselWrapper.vue";
import { getCollection } from "astro:content";

import { getImage } from "astro:assets";
import type { PlaceCard } from "@/components/placeCards/PlaceCard";


const categories = await getCollection("category");

const specialItems = await Promise.all(categories.map(async (category) => {

    let image = await getImage({src: category.data.heroImage});
    
    let imageUrl = image.src;

    return {
        title: category.data.name,
        content: category.data.description ,
        image: imageUrl,
        href: `/category/${category.slug}`
    } as PlaceCard
}))

const carouselItems = specialItems.slice(0, 7)

---
<section>
    <H2 color="coral" position="center" >
        Independent Businesses
    </H2>

    <CarouselWrapper client:load items={carouselItems}/>
    </CarouselWrapper>

</section>